= Publishing Plugins to Gradle Plugin Portal
:portal: Gradle Plugin Portal
:plugin: Greeting Plugin
:publishplugin: Plugin Publishing Plugin

Sharing a plugin with others means publishing it to any type of repository that is supported by Gradle. Sharing a plugin on a global scale requires using a well-known repository. the https://plugins.gradle.org[{portal}] provides a centralised repository that is dedicated to Gradle plugins and which is also easily searchable.

The https://plugins.gradle.org/plugin/com.gradle.plugin-publish[{publishplugin}] provides a convenient DSL to publish to the {portal} and reduce a large number of configuration steps that might be needed when publishing to another Maven repository. It also provides a number of checks to validate that your plugin meets the criteria for publishing to the {portal}.

== What you'll build

You will take an existing plugin and configure its project so that the plugin is publishable to the {portal}.

== What you'll need

* About 25 minutes
* A text editor
* A command prompt
* The Java Development Kit (JDK), version 1.7 or higher
* A https://gradle.org/install[Gradle distribution], version {gradle-version} or better
* Source code for an existing Gradle plugin. (Preferably your own).

NOTE: If you have never written a plugin, you can look at the https://github.com/gradle-guides/greeting-plugin-example[Greeting Plugin example], but please do not try to publish this to the {portal}. You can also look at {guides}writing-gradle-plugins[Writing Gradle Plugins].

== Create an account on the {portal}

If you never published a plugin before you need to create a account on the {portal}. This consists of three steps:

. Create an account.
. Create an API key.
. Add your API key to your Gradle configuration.

Firstly go to the https://plugins.gradle.org/user/register[registration page] and create an account.

.Regustration page
image::registration-page-552x432.png[]

Follow the instructions and once you have logged in, you can get your API key via the “API Keys” tab of your profile page.

.API keys is the third tab
image::api-keys-833x103.png[]

It is common practice to copy-paste the text into your `$HOME/.gradle/gradle.properties` file, but if you wish you can place it elsewhere. All that the plugin requires is that `gradle.publish.key` and `gradle.publish.secret` are available as project properties when the appropriate Plugin portal tasks are executed.

Once you have the API key you can publish as many plugins as you like.

== Add the {publishplugin} to the project

Add the {publishplugin} to the `plugins` block.

.build.gradle
[source,groovy]
----
include::{exampledir}/build.gradle[tags=plugins_block,indent=0]
----
<1> The latest version can be found on https://plugins.gradle.org/plugin/com.gradle.plugin-publish[portal].

== Configure the {publishplugin}

Create a `pluginBundle` block and specify global information regarding your plugin. (it can also be about a bundle of plugins). This helps other people which a browsing the portal to find more information about your plugin and possibly how to contribute to its development.

.build.gradle
[source,groovy]
----
include::{exampledir}/build.gradle[tags=plugin_bundle]
----
<1> Everything for the plugin is configured in the `pluginBundle` extension block.
<2> Set the website for your plugin's project.
<3> Provide the source repository URI so that others can find it if they want to contribute.

Now specify the details of the plugin. This is done in a `plugins` block within the `pluginBundle` block. The most important part is the `id` as that is what will uniquely identify it on the {portal} and prevent namespace clashes between different plugin authors. Substitute the values from this example with ones specific to your plugin. Take your time to think about good entries as all of this contribute to a better experience for people looking for specific plugins

.build.gradle
[source,groovy]
----
pluginBundle {
include::{exampledir}/build.gradle[tags=plugin_definitions,indent=2]
}
----
<1> Each plugin in a bundle is specified in the `plugins` block. As you are only publishing a single plugin at this point there will only be one entry, but should your project publish a bundle in future you will list each of them in here.
<2> The name for each plugin block does not affect the plugin configuration, but they need to be unique for each plugin provided in the `plugins` block.
<3> This is the same identifier specified as the name of plugin properties file that is located in the `src/main/resources/META-INF/gradle-plugins` directory.
<4> Set the plugin name in human-readable form.
<5> Set a description that will be displayed on the portal. Although this is optional it provides useful information to people would might want to use your plugin and it is highly recommended to spend some time on this property.
<6> Set tags that might build script authors might use to search for plugin types. This can make your plugin easier to locate.
<7> By default the version from `project.version` will be used, but you can set your own version if required.


Congratulation, You are now ready to publish your plugin.

== Publish your plugin

Publish the plugin by using the `publishPlugin` task.

[listing]
----
$ ./gradlew publishPlugins
----

If you have not configured your {portal} key and secret in your `gradle.properties` file you can specify it on the command-line

[listing]
----
$ ./gradlew publishPlugins -Pgradle.publish.key=<key> -Pgradle.publish.secret=<secret>
----

== Consume the published plugin

Once your plugin has been published, the instructions for others to use it will automatically appear on the plugin under a URL such as `https://plugins.gradle.org/plugin/<your-plugin-id>`.

== Next steps

* Read the https://plugins.gradle.org/docs/publish-plugin[reference documentation for the {publishplugin}].
